# GDB Learning

## Check whether device will generate `core dump file`, when program crash
```shell
$ ulimit -a 

core file size          (blocks, -c) 0
data seg size           (kbytes, -d) unlimited
scheduling priority             (-e) 0
file size               (blocks, -f) unlimited
pending signals                 (-i) 27091
max locked memory       (kbytes, -l) 65536
max memory size         (kbytes, -m) unlimited
open files                      (-n) 1024
pipe size            (512 bytes, -p) 8
POSIX message queues     (bytes, -q) 819200
real-time priority              (-r) 0
stack size              (kbytes, -s) 8192
cpu time               (seconds, -t) unlimited
max user processes              (-u) 27091
virtual memory          (kbytes, -v) unlimited
file locks                      (-x) unlimited
```
> core file size is 0, it means it won't gen core dump file, when program crash

* Complie 
```shell
$ gcc -g -O0 bug.c
$ ./a.out

Segmentation fault
```

* Using follow command to modify specific file config
```shell
$ sudo sh -c "ulimit -c unlimited; ./test"
$ ls -l

-rwxrwxr-x 1 tony tony  10808    11 10:54 a.out*
-rw------- 1 root  root  249856    11 10:50 core
-rw-rw-r-- 1 tony tony    189    11 10:54 test.c
```
* Debug with gdb
```shell
$ sudo gdb a.out core

GNU gdb (Ubuntu 8.1.1-0ubuntu1) 8.1.1
Copyright (C) 2018 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-linux-gnu".
Type "show configuration" for configuration details.
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>.
Find the GDB manual and other documentation resources online at:
<http://www.gnu.org/software/gdb/documentation/>.
For help, type "help".
Type "apropos word" to search for commands related to "word"...
Reading symbols from ./a.out...done.

warning: exec file is newer than core file.
[New LWP 8936]
Core was generated by `./a.out'.
Program terminated with signal SIGSEGV, Segmentation fault.
#0  0x0000564cbdeda60d in test () at print.c:7
7       print.c: No such file or directory.
(gdb)
```
* Insert `where`
```shell
(gdb) where
#0  0x0000564cbdeda60d in test () at print.c:7
#1  0x0000564cbdeda62c in main (argc=1, argv=0x7ffcda984bb8) at print.c:12
```

* Insert `p s`
```shell
(gdb) p s
$2 = 0x564cbdeda6c4 "abc"
```
* Insert `info file`
```shell
(gdb) info files
Symbols from "/home/test_space/a.out".
Local core dump file:
        `/home/test_space/core', file type elf64-x86-64.
        0x0000564cbdeda000 - 0x0000564cbdedb000 is load1
        0x0000564cbe0da000 - 0x0000564cbe0db000 is load2
        ...
Local exec file:
        `/home/test_space/a.out', file type elf64-x86-64.
        Entry point: 0x564cbdeda4f0
        0x0000564cbdeda238 - 0x0000564cbdeda254 is .interp
        0x0000564cbdeda254 - 0x0000564cbdeda274 is .note.ABI-tag
        ...
        0x0000564cbdeda6c0 - 0x0000564cbdeda6c8 is .rodata
```
> `.rodata` is read only.
